<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form id="checkoutForm">
  <input required name="name" placeholder="Full Name">
  <input required name="email" placeholder="Email">
  <input required name="phone" placeholder="Phone">
  <textarea required name="address" placeholder="Delivery Address"></textarea>

  <button type="submit">Pay with PayFast</button>
</form>

<script>
document.getElementById("checkoutForm").onsubmit = async (e) => {
  e.preventDefault();

  const form = Object.fromEntries(new FormData(e.target));
  const cart = JSON.parse(localStorage.getItem("cart"));

  const res = await fetch("http://localhost:3000/create-payment", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ form, cart })
  });

  const html = await res.text();
  document.body.innerHTML = html; // auto redirect form
};
</script>

</body>
</html>